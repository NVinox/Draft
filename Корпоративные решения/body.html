<script async defer>
  const HEADER = document.getElementById("transparentHeader");
  const MENU_BUTTON = document.getElementById("menuButton");
  const CLOSE_MENU = document.getElementById("closeMenu");
  const HERO_SECTION = document.getElementById("hero");

  const REVIEWS_DATA = [
    {
      buttonDesktopId: "grillButton",
      buttonMobileId: "grillMobileButton",
      reviewId: "reviewGrill",
    },
    {
      buttonDesktopId: "stroyparkButton",
      buttonMobileId: "stroyparkMobileButton",
      reviewId: "reviewStroypark",
    },
    {
      buttonDesktopId: "yavesButton",
      buttonMobileId: "yavesMobileButton",
      reviewId: "reviewYaves",
    },
  ];

  async function loadSwiperScript() {
    return new Promise((e, i) => {
      const n = document.createElement("script");
      (n.src = "https://unpkg.com/swiper@11.1.1/swiper-bundle.min.js"),
        (n.async = !0),
        (n.onload = e),
        (n.onerror = i),
        document.head.appendChild(n);
    });
  }

  function initializeSwiperSolutions() {
    new Swiper("#solutions-swiper", {
      slidesPerView: 1,
      grabCursor: !0,
      slidesPerGroup: 1,
      a11y: !1,
      spaceBetween: 100,
      autoHeight: !1,
      loop: 10,
      navigation: {
        nextEl: "#solution-swiper-nav-next",
        prevEl: "#solution-swiper-nav-prev",
      },
      pagination: {
        el: ".pagination",
        clickable: !0,
      },
    });
  }

  function initializeSwiperEnterprice() {
    new Swiper("#enterpriceSwiper", {
      slidesPerView: 1,
      grabCursor: true,
      slidesPerGroup: 1,
      spaceBetween: 30,
      autoHeight: false,
      loop: true,
      breakpoints: {
        767: {
          slidesPerView: 2,
          spaceBetween: 30,
        },
        991: {
          slidesPerView: 1,
          spaceBetween: 60,
        },
        1350: {
          slidesPerView: 2,
          spaceBetween: 60,
        },
      },
      navigation: {
        nextEl: "#enterprice-swiper-nav-next",
        prevEl: "#enterprice-swiper-nav-prev",
      },
      pagination: {
        el: ".pagination",
        clickable: true,
      },
    });
  }

  function initializeSwiperReviews() {
    new Swiper("#reviews-swiper", {
      slidesPerView: 1,
      grabCursor: true,
      slidesPerGroup: 1,
      a11y: false,
      spaceBetween: 40,
      autoHeight: false,
      loop: true,
      speed: 500,
      navigation: {
        prevEl: "#reviews-swiper-nav-prev",
        nextEl: "#reviews-swiper-nav-next",
      },
    });
  }

  function openReviewModal(reviewImageId) {
    const reviewImage = document.getElementById(reviewImageId);

    REVIEWS_DATA.forEach(({ reviewId }) => {
      if (reviewId === reviewImageId) {
        reviewImage.style.display = "inline-block";
      } else {
        const overReviewImage = document.getElementById(reviewId);
        overReviewImage.style.display = "none";
      }
    });
  }

  function scrollPage() {
    const heroSectionHeight = HERO_SECTION.clientHeight;
    const headerHeight = HEADER.clientHeight;
    const windowScroll = document.documentElement.scrollTop;
    const isHeroInvisible = windowScroll >= heroSectionHeight - headerHeight;

    if (isHeroInvisible) {
      changeHeaderWhite();
    } else {
      const navOverlay = document.getElementById("w-nav-overlay-0");
      const isNavOverlay = navOverlay?.style?.display === "block";

      if (isNavOverlay) {
        changeHeaderWhite();
      } else {
        changeHeaderTransparent();
      }
    }
  }

  function clickMenu() {
    const heroSectionHeight = HERO_SECTION.clientHeight;
    const headerHeight = HEADER.clientHeight;
    const windowScroll = document.documentElement.scrollTop;
    const isHeroInvisible = windowScroll >= heroSectionHeight - headerHeight;

    if (isHeroInvisible) {
      changeHeaderWhite();
    } else {
      const isMenuOpened = MENU_BUTTON.classList.contains("w--open");

      if (isMenuOpened) {
        changeHeaderTransparent();
      } else {
        changeHeaderWhite();
      }
    }
  }

  function changeHeaderTransparent() {
    HEADER.classList.add("transparent");
    HEADER.style.backgroundColor = "rgba(0, 0, 0, 0)";
  }

  function changeHeaderWhite() {
    HEADER.classList.remove("transparent");
    HEADER.style.backgroundColor = "white";
  }

  document.addEventListener("DOMContentLoaded", async function () {
    await loadSwiperScript();
    initializeSwiperSolutions();
    initializeSwiperEnterprice();
    initializeSwiperReviews();
  });

  document.addEventListener("DOMContentLoaded", function () {
    const ACTIVE_CLASS = "active";
    const content = {
      integration1CBtn: "integration1CInfo",
      scoringBtn: "scoringInfo",
      asutpBtn: "asutpInfo",
      bigDataBtn: "bigDataInfo",
      taskTrackerBtn: "taskTrackerInfo",
      mesSystemBtn: "mesSystemInfo",
      crmBtn: "crmInfo",
      pdmPlmBtn: "pdmPlmInfo",
    };

    Object.keys(content).forEach(function (buttonId) {
      const button = document.getElementById(buttonId);
      const infoBlock = document.getElementById(content[buttonId]);

      button.addEventListener(
        "click",
        onClickPlanet.bind(null, button, infoBlock)
      );
    });

    function onClickPlanet(activeButton, activeInfoBlock) {
      const activeButtonChildrens = activeButton.childNodes;

      Object.keys(content).forEach(function (buttonId) {
        const button = document.getElementById(buttonId);
        const infoBlock = document.getElementById(content[buttonId]);
        const childrens = button.childNodes;

        infoBlock.classList.remove(ACTIVE_CLASS);

        childrens.forEach(function (children) {
          children.classList.remove(ACTIVE_CLASS);
        });
      });

      activeInfoBlock.classList.add(ACTIVE_CLASS);
      activeButtonChildrens.forEach(function (children) {
        children.classList.add(ACTIVE_CLASS);
      });
    }
  });

  document.addEventListener("DOMContentLoaded", () => {
    CLOSE_MENU.addEventListener("click", (e) => {
      e.preventDefault();
      clickMenu();
    });
    MENU_BUTTON.addEventListener("click", clickMenu);
    document.addEventListener("scroll", scrollPage);

    scrollPage();
  });

  document.addEventListener("DOMContentLoaded", () => {
    REVIEWS_DATA.forEach(({ buttonDesktopId, buttonMobileId, reviewId }) => {
      const buttonDesktop = document.getElementById(buttonDesktopId);
      const buttonMobile = document.getElementById(buttonMobileId);

      buttonDesktop.addEventListener(
        "click",
        openReviewModal.bind(this, reviewId)
      );
      buttonMobile.addEventListener(
        "click",
        openReviewModal.bind(this, reviewId)
      );
    });
  });

  document.addEventListener("DOMContentLoaded", function () {
    let form = document.getElementById("header-form");
    form.addEventListener("submit", function (event) {
      ym(49180180, "reachGoal", "form_header_send", {
        form_header_send_url: window.location.href,
      });
    });
  });

  document.addEventListener("DOMContentLoaded", function () {
    let form = document.getElementById("footer-form");
    form.addEventListener("submit", function (event) {
      ym(49180180, "reachGoal", "form_footer_send", {
        form_footer_url: window.location.href,
      });
    });
  });
</script>
